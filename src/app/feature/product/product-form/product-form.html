<form [formGroup]="form" (ngSubmit)="onSubmit()" class="producto-container">
  <!-- TÍTULO -->
  <h2 class="form-title">
    {{ isEditMode ? 'Modificar Producto' : 'Registrar Producto' }}
  </h2>

  <!-- DIVISOR -->
  <hr class="custom-divider" />

  <!-- SECCIÓN DATOS DEL PRODUCTO -->
  <div class="section-header">
    <mat-icon>inventory_2</mat-icon>
    <span>Datos del Producto</span>
  </div>

  <div class="form-container">
    <!-- Código solo en modo edición -->
    <div *ngIf="isEditMode" class="form-group full-width">
      <label for="code">Código</label>
      <input id="code" type="text" formControlName="code" readonly />
    </div>

    <!-- Nombre -->
    <div class="form-group full-width">
      <label for="name">Nombre</label>
      <input id="name" type="text" formControlName="name" required />
      <div class="error" *ngIf="form.get('name')?.hasError('required')">El nombre es obligatorio.</div>
      <div class="error" *ngIf="form.get('name')?.hasError('multipleSpaces')">No se permiten múltiples espacios.</div>
    </div>

    <!-- Descripción -->
    <div class="form-group full-width">
      <label for="description">Descripción</label>
      <textarea id="description" formControlName="description" rows="3" required></textarea>
      <div class="error" *ngIf="form.get('description')?.hasError('required')">La descripción es obligatoria.</div>
      <div class="error" *ngIf="form.get('description')?.hasError('multipleSpaces')">No se permiten múltiples espacios.</div>
    </div>

    <!-- Volumen / Unidad / Stock / Precio -->
    <div class="form-row">
      <div class="form-group">
        <label for="volumeWeight">Volumen/Peso</label>
        <input id="volumeWeight" type="number" step="0.01" formControlName="volumeWeight" />
        <div class="error" *ngIf="form.get('volumeWeight')?.hasError('required')">Campo obligatorio.</div>
      </div>

      <div class="form-group">
        <label for="unitMeasure">Unidad de Medida</label>
        <select id="unitMeasure" formControlName="unitMeasure" required>
          <option value="">Seleccione...</option>
          <option value="Kilogramos">Kilogramos</option>
          <option value="Gramos">Gramos</option>
          <option value="Litros">Litros</option>
          <option value="Mililitros">Mililitros</option>
          <option value="Unidades">Unidades</option>
          <option value="Cajas">Cajas</option>
          <option value="Paquetes">Paquetes</option>
        </select>
      </div>

      <div class="form-group">
        <label for="stock">Stock</label>
        <input id="stock" type="number" formControlName="stock" />
        <div class="error" *ngIf="form.get('stock')?.hasError('min')">Debe ser mayor a 0.</div>
      </div>

      <div class="form-group">
        <label for="price">Precio</label>
        <input id="price" type="number" formControlName="price" step="0.01" />
        <div class="error" *ngIf="form.get('price')?.hasError('min')">Debe ser mayor a 0.</div>
      </div>
    </div>

    <!-- Categoría + Fecha -->
    <div class="form-row">
      <div class="form-group">
        <label for="category">Categoría</label>
        <select id="category" formControlName="category" required>
          <option value="">Seleccione...</option>
          <option value="Alimentos">Alimentos</option>
          <option value="Bebidas">Bebidas</option>
          <option value="Limpieza">Limpieza</option>
          <option value="Cuidado Personal">Cuidado Personal</option>
          <option value="Hogar">Hogar</option>
          <option value="Otros">Otros</option>
        </select>
      </div>

      <div class="form-group">
        <label for="expirationDate">Fecha de Vencimiento</label>
        <input id="expirationDate" type="date" formControlName="expirationDate" />
        <div class="error" *ngIf="form.get('expirationDate')?.hasError('futureDate')">Debe tener mínimo 30 días.</div>
        <div class="error" *ngIf="form.get('expirationDate')?.hasError('tooFarDate')">Máximo 5 años.</div>
        <div class="error" *ngIf="form.get('expirationDate')?.hasError('noSunday')">No puede ser domingo.</div>
      </div>
    </div>
  </div>

  <!-- BOTONES -->
  <div class="button-group">
    <button mat-raised-button color="primary" type="submit" [disabled]="form.invalid" class="btn-primary">
      <mat-icon>save</mat-icon>
      {{ isEditMode ? 'Actualizar' : 'Registrar' }}
    </button>

    <button mat-raised-button type="button" (click)="onCancel()" class="btn-warn">
      <mat-icon>close</mat-icon>
      Cancelar
    </button>
  </div>

  <!-- ALERTA -->
  <app-alert
    [message]="alertMessage"
    [type]="alertType"
    [visible]="showAlert"
    [confirm]="confirmAlert"
    (close)="showAlert = false"
    (confirmResult)="handleAlertConfirm($event)">
  </app-alert>
</form>
