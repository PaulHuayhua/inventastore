<div class="cont mat-elevation-z8">
    <h2 class="title">COMPRAS</h2>

    <div class="top-bar">
        <input matInput type="text" placeholder="Buscar compra" class="search-input" (keyup)="applyFilter($event)" />
        <div class="right-actions">
            <button mat-raised-button class="btn-agregar" (click)="goBuyForm()">
                <span class="btn-icon">+</span>Nueva Compra</button>
        </div>
    </div>

    <div class="container">
        <div class="table-container">
            <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8" multiTemplateDataRows>

                <!-- identifier -->
                <!-- code (reemplaza a identifier visualmente) -->
                <ng-container matColumnDef="code">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> N° Código </th>
                    <td mat-cell *matCellDef="let buy"> {{ buy.code }} </td>
                </ng-container>

                <!-- buys_date -->
                <ng-container matColumnDef="buys_date">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Fecha y Hora de Registro</th>
                    <td mat-cell *matCellDef="let buy"> {{ buy.buysDate }} </td>
                </ng-container>

                <!-- user_identifier -->
                <ng-container matColumnDef="user_identifier">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Usuario </th>
                    <td mat-cell *matCellDef="let buy"> {{ getUserName(buy.user_identifier) }} </td>
                </ng-container>

                <!-- supplier_identifier -->
                <ng-container matColumnDef="supplier_identifier">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Proveedor </th>
                    <td mat-cell *matCellDef="let buy"> {{ getSupplierName(buy.supplier_identifier) }} </td>
                </ng-container>

                <!-- payment_method -->
                <ng-container matColumnDef="payment_method">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Método de Pago </th>
                    <td mat-cell *matCellDef="let buy"> {{ buy.payment_method }} </td>
                </ng-container>

                <!-- totalCompra -->
                <ng-container matColumnDef="totalPrice">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Total Compra </th>
                    <td mat-cell *matCellDef="let buy">
                        S/{{ buy.totalPrice }}
                    </td>
                </ng-container>

                <ng-container matColumnDef="acciones">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Acciones </th>
                    <td mat-cell *matCellDef="let buy">
                        <!-- Ver Detalles -->
                        <button mat-icon-button color="accent" (click)="verDetalle(buy)">
                            <mat-icon>visibility</mat-icon>
                        </button>

                        <!-- Descargar PDF -->
                        <button mat-icon-button color="primary" (click)="reportPdf(buy.identifier)">
                            <mat-icon>picture_as_pdf</mat-icon>
                        </button>
                    </td>
                </ng-container>




                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>
        </div>
    </div>
</div>